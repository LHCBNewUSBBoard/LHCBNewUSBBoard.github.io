<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Development Process - My Docs</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Development Process";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> My Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">USBBoard for SiPM readout</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../System_Structure/">System Structure</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 current">
        <a class="current" href="./">Development Process</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#-hardware-">--------------Hardware--------------</a></li>
                
                    <li><a class="toctree-l4" href="#11-development-tools-projects">1.1 Development Tools &amp; Projects</a></li>
                
            
                <li class="toctree-l3"><a href="#-firmware-">--------------Firmware--------------</a></li>
                
                    <li><a class="toctree-l4" href="#21-development-tools">2.1 Development Tools</a></li>
                
                    <li><a class="toctree-l4" href="#21-development-process">2.1 Development Process</a></li>
                
            
                <li class="toctree-l3"><a href="#-software-">--------------Software--------------</a></li>
                
                    <li><a class="toctree-l4" href="#31-development-tools-chains">3.1 Development Tools &amp; Chains</a></li>
                
            
                <li class="toctree-l3"><a href="#32-qmake-project">3.2 Qmake project</a></li>
                
            
            </ul>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../Operation_Manual/">Operation Manual</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../BugIssues_FreqAsks/">Bug Issues & Freq Asks</a>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">My Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Development Process</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="-hardware-"><strong>--------------Hardware--------------</strong></h1>
<h2 id="11-development-tools-projects">1.1 Development Tools &amp; Projects</h2>
<h3 id="altium-designer">Altium Designer</h3>
<p>Projects listed below are developed with Altium Designer (Version 15.0.7):</p>
<ul>
<li>NewUSBBoard -- database/hardware/ADBV2</li>
<li>NewUSBBoard piggyback  -- database/hardware/ADB-PiggybackV2.0</li>
</ul>
<h3 id="cadence">Cadence</h3>
<p>Project listed below are developed with Cadence:</p>
<ul>
<li>SpirocA board -- database/hardware/HPE-SPIROCA-256-LHCB</li>
<li>Laser Driver board -- database/hardware/LaserDriver</li>
<li>PACIFIC board</li>
</ul>
<hr />
<h1 id="-firmware-"><strong>--------------Firmware--------------</strong></h1>
<h2 id="21-development-tools">2.1 Development Tools</h2>
<h3 id="hdl-designer-20121">HDL Designer 2012.1</h3>
<p>Download link: <a href="https://www.dropbox.com/sh/y4ez3cina23jm0n/AABKDodnH0p8M3dCEn6UZaN6a?dl=0">HDS_2012_1</a></p>
<h3 id="quartus-120">Quartus 12.0</h3>
<p>Download link <a href="https://www.dropbox.com/sh/8u0c2a4gspacje9/AABWuuPtDBv_I5enYoXupX1ea?dl=0">Quartus_12_0</a></p>
<h2 id="21-development-process">2.1 Development Process</h2>
<h3 id="edit-source-code">Edit Source Code</h3>
<p>Download the souce code from https://bitbucket.org/</p>
<ol>
<li>Make a new directory D:\NewUSBBoard</li>
<li>cd D:\NewUSBBoard</li>
<li>git clone https://lihm09@bitbucket.org/XiaoxueHAN/usbboard_firmware.git firmware</li>
<li>Set the environment variables</li>
<li>Run D:\NewUSBBoard\firmware\Setup_Env\SET_ENV_VAR.bat as Administrator.</li>
<li>Edit source code in the HDL Designer.</li>
</ol>
<h3 id="synthesis-in-hdl-designer">Synthesis in HDL Designer</h3>
<p>USB_Board_TOP_tb-&gt;struct-&gt;U_0 is the top file of the project.<br />
USB_Board_TOP_tb-&gt;struct-&gt;U_1 is the testbench, which can only be used for simulating.</p>
<p><img alt="HDS Project" src="../pics/HDS_Project.jpg" title="HDS Proejct" /></p>
<p>In “FPGA Technology Setup” choose the options:
<img alt="HDS Technology Setup" src="../pics/HDS_Tech_Setup.jpg" title="HDS Technology Setup" /></p>
<p>In "FPGA Synthesis Settings" choose the options:
<img alt="HDS Synthesis Settings" src="../pics/HDS_Syn_Set.jpg" title="HDS Synthesis Settings" /></p>
<p>Choose U_0 and click “Generate and runs the entires Quartus QIS Synthesis flow” to synthesis the project, then wait for Synthesis completed.</p>
<h3 id="implementation-in-quartus">Implementation in Quartus</h3>
<ol>
<li>
<p>Open Quartus and the project file PEBSino_USB_Board\qis\@u@s@b_@board_@t@o@p_struct\USB_Board_TOP.qpf .</p>
</li>
<li>
<p>Run the command below in the Tcl console, the file will set the type of the device and all the pin planning &amp; constrains.</p>
<blockquote>
<p>source USB_Board_TOP.tcl</p>
</blockquote>
</li>
<li>
<p>Start compilation.</p>
</li>
</ol>
<h3 id="program-the-fpga">Program the FPGA</h3>
<ul>
<li>Use JTAG and *.sof to program the FPGA for preliminary tests.</li>
<li>Use ISP interface to program the flash  </li>
<li>Use "Convert Programming Files" to generate .jic file to program the flash<br />
(flash device is EPCS64, FPGA device is EP4CE75F23I8L)  </li>
<li>The FPGA can also be programed using the software tools through QuickUSB module.<br />
Use <code>hdReadoutTest ... -f</code> to program the FPGA. (More details, try <code>hdReadoutTest -h</code>)</li>
</ul>
<hr />
<h1 id="-software-"><strong>--------------Software--------------</strong></h1>
<h2 id="31-development-tools-chains">3.1 Development Tools &amp; Chains</h2>
<h3 id="operation-system">Operation System:</h3>
<ul>
<li>ubuntu 12.04.3 amd64  </li>
</ul>
<h3 id="pre-install-software">Pre-install Software:</h3>
<ul>
<li>git, g++, qt4, libusb, dkpg, make, gcc, binutils, libx11, libxpm, libxft, libxext, qt4, libusb<br />
<code>sudo apt-get install git dpkg-dev make g++ gcc binutils libx11-dev libxpm-dev libxft-dev \
libxext-dev libqt4-dev libusb-dev libaio.so.1</code></li>
<li><a href="http://www.fftw.org/fftw-3.3.4.tar.gz">FFTW</a><blockquote>
<ol>
<li>download source code and unzip the file to /opt/  </li>
<li>under /opt/fftw-3.3.4, run <code>./configure</code></li>
<li>under /opt/fftw-3.3.4, run <code>./make</code></li>
<li>under /opt/fftw-3.3.4, run <code>sudo ./make install</code></li>
</ol>
</blockquote>
</li>
<li><a href="https://root.cern.ch/drupal/content/production-version-534">rootV5.34/32</a><blockquote>
<ol>
<li>download source code and unzip the file to /opt/  </li>
<li>under /opt/root, run <code>sudo ./configure --enable-qt --with-fftw3-incdir="/opt/fftw-3.3.4/api" --with-fftw3-libdir="/opt/fftw-3.3.4/.libs"</code></li>
<li>under /opt/root run <code>sudo make</code></li>
</ol>
</blockquote>
</li>
<li><a href="http://download.qt.io/official_releases/qtcreator/2.8/2.8.1/qt-creator-linux-x86_64-opensource-2.8.1.run">qtcreatorV2.8.1</a></li>
</ul>
<h3 id="source-code">Source Code</h3>
<ul>
<li>
<p>Download source code from bitbucket</p>
<blockquote>
<p><code>git clone https://lihm09@bitbucket.org/RomanGreim/scifiusbboard.git</code>  </p>
</blockquote>
</li>
<li>
<p>install the QuicUSB Driver</p>
<blockquote>
<p><code>tar -xvf scifiusbboard/support/QuickUsbLibrary_v2.15.2_Linux.tar.gz</code><br />
<code>cd scifiusbboard/support/QuickUsbLibrary_v2.15.2_Linux</code><br />
<code>sudo ./install-linux.sh</code></p>
</blockquote>
</li>
<li>
<p>Install libiowkit</p>
<blockquote>
<p><code>cd scifiusbboard/utils/lisProgrammer/libiowkit</code><br />
<code>./configure</code><br />
<code>make</code><br />
<code>sudo make install</code>  </p>
</blockquote>
</li>
<li>
<p>Compilation</p>
<blockquote>
<p><code>qmake</code><br />
<code>make</code></p>
</blockquote>
</li>
</ul>
<h1 id="32-qmake-project">3.2 Qmake project</h1>
<ul>
<li>*.pro/*.pri -- qmake project file</li>
<li>*.h -- header file</li>
<li>*.cpp -- cpp file</li>
<li>*.ui -- ui file, edited by qtcreator</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Operation_Manual/" class="btn btn-neutral float-right" title="Operation Manual"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../System_Structure/" class="btn btn-neutral" title="System Structure"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../System_Structure/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Operation_Manual/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
